start
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_0/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_0/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_0/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_0/ast.
Restoring best model state from result_nvidia_new_0/RGIN_GraphBinaryClassification__2020-06-28_20-52-21_best.pkl.
tf.Tensor(
[1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 0. 1. 1. 1. 1. 0. 1. 1. 0. 0. 0. 0. 1.
 1. 0. 0. 0. 0. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00825  |  Batch graph avg. loss = 0.00825  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 0. 1. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 0. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.00961  |  Batch graph avg. loss = 0.01097  |  Steps per sec = 0.23490tf.Tensor([0. 0. 0. 0. 1.], shape=(5,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01223  |  Batch graph avg. loss = 0.04581  |  Steps per sec = 0.46374[KAccuracy = 0.826
[06/28/2020, 09:36:15 PM] INFO (nni) Final result: 0.826
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_1/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_1/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_1/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_1/ast.
Restoring best model state from result_nvidia_new_1/RGIN_GraphBinaryClassification__2020-06-28_20-55-47_best.pkl.
tf.Tensor(
[1. 1. 1. 1. 1. 0. 0. 0. 1. 0. 1. 1. 0. 0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01453  |  Batch graph avg. loss = 0.01453  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0.
 0. 0. 1. 1. 0. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01605  |  Batch graph avg. loss = 0.01757  |  Steps per sec = 0.23657tf.Tensor([1. 0. 0. 1. 0.], shape=(5,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.02152  |  Batch graph avg. loss = 0.09152  |  Steps per sec = 0.46811[KAccuracy = 0.812
[06/28/2020, 09:36:28 PM] INFO (nni) Final result: 0.812
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_2/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_2/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_2/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_2/ast.
Restoring best model state from result_nvidia_new_2/RGIN_GraphBinaryClassification__2020-06-28_20-58-34_best.pkl.
tf.Tensor(
[1. 1. 1. 0. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 0. 0. 0. 1. 1. 1. 0. 1. 1. 1.
 0. 0. 0. 1. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01137  |  Batch graph avg. loss = 0.01137  |  Steps per sec = 0.00000tf.Tensor(
[0. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 1.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01241  |  Batch graph avg. loss = 0.01346  |  Steps per sec = 0.23533tf.Tensor([0. 1. 0. 0. 0.], shape=(5,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01911  |  Batch graph avg. loss = 0.10479  |  Steps per sec = 0.46689[KAccuracy = 0.797
[06/28/2020, 09:36:40 PM] INFO (nni) Final result: 0.797
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_3/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_3/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_3/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_3/ast.
Restoring best model state from result_nvidia_new_3/RGIN_GraphBinaryClassification__2020-06-28_21-01-25_best.pkl.
tf.Tensor(
[1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 1. 1. 1. 0. 1. 0. 1. 1. 1. 1. 1. 1. 1.
 1. 0. 1. 1. 1. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01414  |  Batch graph avg. loss = 0.01414  |  Steps per sec = 0.00000tf.Tensor(
[1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 1. 0. 0. 1. 1. 1. 1. 0. 0. 0.
 0. 1. 0. 1. 1. 0. 0. 1.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01560  |  Batch graph avg. loss = 0.01707  |  Steps per sec = 0.22954tf.Tensor([1. 0. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01951  |  Batch graph avg. loss = 0.08210  |  Steps per sec = 0.45466[KAccuracy = 0.779
[06/28/2020, 09:36:53 PM] INFO (nni) Final result: 0.779
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_4/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_4/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_4/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_4/ast.
Restoring best model state from result_nvidia_new_4/RGIN_GraphBinaryClassification__2020-06-28_21-05-06_best.pkl.
tf.Tensor(
[1. 1. 1. 1. 1. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1.
 1. 1. 0. 0. 0. 0. 0. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01139  |  Batch graph avg. loss = 0.01139  |  Steps per sec = 0.00000tf.Tensor(
[1. 1. 1. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 1. 1. 1. 1. 1. 0. 0. 0. 1. 0. 1.
 1. 1. 0. 1. 0. 1. 1. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01025  |  Batch graph avg. loss = 0.00912  |  Steps per sec = 0.22926tf.Tensor([1. 0. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.02137  |  Batch graph avg. loss = 0.19923  |  Steps per sec = 0.45388[KAccuracy = 0.838
[06/28/2020, 09:37:06 PM] INFO (nni) Final result: 0.838
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_5/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_5/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_5/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_5/ast.
Restoring best model state from result_nvidia_new_5/RGIN_GraphBinaryClassification__2020-06-28_21-08-56_best.pkl.
tf.Tensor(
[1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 0. 0. 1. 1. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01063  |  Batch graph avg. loss = 0.01063  |  Steps per sec = 0.00000tf.Tensor(
[1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 0. 0. 0. 1. 1. 1. 1. 1. 0.
 0. 0. 0. 0. 1. 1. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01132  |  Batch graph avg. loss = 0.01201  |  Steps per sec = 0.22579tf.Tensor([0. 0. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.02204  |  Batch graph avg. loss = 0.19355  |  Steps per sec = 0.44722[KAccuracy = 0.824
[06/28/2020, 09:37:18 PM] INFO (nni) Final result: 0.824
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_6/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_6/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_6/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_6/ast.
Restoring best model state from result_nvidia_new_6/RGIN_GraphBinaryClassification__2020-06-28_21-22-26_best.pkl.
tf.Tensor(
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00817  |  Batch graph avg. loss = 0.00817  |  Steps per sec = 0.00000tf.Tensor(
[1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 1. 1. 1. 1. 0. 0. 1.
 0. 1. 0. 0. 1. 0. 1. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.00873  |  Batch graph avg. loss = 0.00928  |  Steps per sec = 0.22932tf.Tensor([0. 0. 0. 1.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.02432  |  Batch graph avg. loss = 0.27381  |  Steps per sec = 0.45482[KAccuracy = 0.824
[06/28/2020, 09:37:31 PM] INFO (nni) Final result: 0.824
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_7/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_7/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_7/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_7/ast.
Restoring best model state from result_nvidia_new_7/RGIN_GraphBinaryClassification__2020-06-28_21-26-03_best.pkl.
tf.Tensor(
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01445  |  Batch graph avg. loss = 0.01445  |  Steps per sec = 0.00000tf.Tensor(
[0. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0.
 1. 1. 0. 1. 0. 0. 0. 1.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01624  |  Batch graph avg. loss = 0.01803  |  Steps per sec = 0.23241tf.Tensor([0. 1. 0.], shape=(3,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.02550  |  Batch graph avg. loss = 0.22299  |  Steps per sec = 0.46011[KAccuracy = 0.806
[06/28/2020, 09:37:44 PM] INFO (nni) Final result: 0.806
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_8/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_8/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_8/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_8/ast.
Restoring best model state from result_nvidia_new_8/RGIN_GraphBinaryClassification__2020-06-28_21-29-30_best.pkl.
tf.Tensor(
[1. 1. 1. 0. 0. 1. 1. 1. 1. 0. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1.
 1. 1. 1. 1. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01468  |  Batch graph avg. loss = 0.01468  |  Steps per sec = 0.00000tf.Tensor(
[0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 0. 0. 0. 0.
 1. 1. 1. 1. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01900  |  Batch graph avg. loss = 0.02333  |  Steps per sec = 0.23049tf.Tensor([0. 0. 0.], shape=(3,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01868  |  Batch graph avg. loss = 0.01176  |  Steps per sec = 0.45563[KAccuracy = 0.836
[06/28/2020, 09:37:56 PM] INFO (nni) Final result: 0.836
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_9/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_9/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/root/case1_zjq/tf2_double/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/nvidia/new_9/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.001}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_9/ast.
Restoring best model state from result_nvidia_new_9/RGIN_GraphBinaryClassification__2020-06-28_21-32-31_best.pkl.
tf.Tensor(
[1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 0. 1. 1.
 1. 1. 1. 1. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00698  |  Batch graph avg. loss = 0.00698  |  Steps per sec = 0.00000tf.Tensor(
[0. 1. 1. 1. 0. 0. 1. 1. 1. 1. 1. 1. 0. 1. 0. 1. 0. 0. 0. 1. 1. 0. 0. 0.
 0. 1. 0. 0. 0. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01495  |  Batch graph avg. loss = 0.02291  |  Steps per sec = 0.22973tf.Tensor([0. 0. 0.], shape=(3,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01630  |  Batch graph avg. loss = 0.04515  |  Steps per sec = 0.45621[KAccuracy = 0.821
[06/28/2020, 09:38:09 PM] INFO (nni) Final result: 0.821
