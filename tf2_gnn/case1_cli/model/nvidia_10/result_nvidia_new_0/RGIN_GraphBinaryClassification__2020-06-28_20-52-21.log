Setting random seed 0.
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
Initial valid metric: Accuracy = 0.660.
== Epoch 1
 Train:  0.0285 loss | Accuracy = 0.535 | 139.07 graphs/s
 Valid:  0.0256 loss | Accuracy = 0.660 | 103.68 graphs/s
== Epoch 2
 Train:  0.0221 loss | Accuracy = 0.606 | 166.64 graphs/s
 Valid:  0.0227 loss | Accuracy = 0.720 | 94.13 graphs/s
  (Best epoch so far, target metric decreased to -0.72000 from -0.66000.)
== Epoch 3
 Train:  0.0212 loss | Accuracy = 0.637 | 165.22 graphs/s
 Valid:  0.0225 loss | Accuracy = 0.700 | 110.99 graphs/s
== Epoch 4
 Train:  0.0208 loss | Accuracy = 0.628 | 177.51 graphs/s
 Valid:  0.0219 loss | Accuracy = 0.720 | 115.18 graphs/s
== Epoch 5
 Train:  0.0203 loss | Accuracy = 0.666 | 182.17 graphs/s
 Valid:  0.0199 loss | Accuracy = 0.720 | 103.25 graphs/s
== Epoch 6
 Train:  0.0195 loss | Accuracy = 0.676 | 169.91 graphs/s
 Valid:  0.0202 loss | Accuracy = 0.740 | 100.83 graphs/s
  (Best epoch so far, target metric decreased to -0.74000 from -0.72000.)
== Epoch 7
 Train:  0.0187 loss | Accuracy = 0.682 | 169.54 graphs/s
 Valid:  0.0186 loss | Accuracy = 0.840 | 101.09 graphs/s
  (Best epoch so far, target metric decreased to -0.84000 from -0.74000.)
== Epoch 8
 Train:  0.0174 loss | Accuracy = 0.725 | 177.07 graphs/s
 Valid:  0.0201 loss | Accuracy = 0.820 | 112.77 graphs/s
== Epoch 9
 Train:  0.0171 loss | Accuracy = 0.725 | 165.15 graphs/s
 Valid:  0.0162 loss | Accuracy = 0.880 | 97.36 graphs/s
  (Best epoch so far, target metric decreased to -0.88000 from -0.84000.)
== Epoch 10
 Train:  0.0162 loss | Accuracy = 0.763 | 163.27 graphs/s
 Valid:  0.0197 loss | Accuracy = 0.840 | 102.62 graphs/s
== Epoch 11
 Train:  0.0150 loss | Accuracy = 0.792 | 170.43 graphs/s
 Valid:  0.0145 loss | Accuracy = 0.860 | 95.77 graphs/s
== Epoch 12
 Train:  0.0131 loss | Accuracy = 0.818 | 165.80 graphs/s
 Valid:  0.0231 loss | Accuracy = 0.700 | 87.02 graphs/s
== Epoch 13
 Train:  0.0148 loss | Accuracy = 0.794 | 159.28 graphs/s
 Valid:  0.0194 loss | Accuracy = 0.720 | 85.69 graphs/s
== Epoch 14
 Train:  0.0140 loss | Accuracy = 0.817 | 156.72 graphs/s
 Valid:  0.0135 loss | Accuracy = 0.900 | 95.28 graphs/s
  (Best epoch so far, target metric decreased to -0.90000 from -0.88000.)
== Epoch 15
 Train:  0.0127 loss | Accuracy = 0.827 | 158.78 graphs/s
 Valid:  0.0148 loss | Accuracy = 0.840 | 86.98 graphs/s
== Epoch 16
 Train:  0.0123 loss | Accuracy = 0.813 | 150.92 graphs/s
 Valid:  0.0133 loss | Accuracy = 0.820 | 93.68 graphs/s
== Epoch 17
 Train:  0.0124 loss | Accuracy = 0.822 | 159.10 graphs/s
 Valid:  0.0121 loss | Accuracy = 0.860 | 81.87 graphs/s
== Epoch 18
 Train:  0.0117 loss | Accuracy = 0.838 | 162.56 graphs/s
 Valid:  0.0123 loss | Accuracy = 0.920 | 106.61 graphs/s
  (Best epoch so far, target metric decreased to -0.92000 from -0.90000.)
== Epoch 19
 Train:  0.0111 loss | Accuracy = 0.848 | 167.92 graphs/s
 Valid:  0.0096 loss | Accuracy = 0.920 | 90.79 graphs/s
== Epoch 20
 Train:  0.0096 loss | Accuracy = 0.861 | 153.21 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.880 | 104.14 graphs/s
== Epoch 21
 Train:  0.0088 loss | Accuracy = 0.863 | 169.10 graphs/s
 Valid:  0.0096 loss | Accuracy = 0.940 | 103.06 graphs/s
  (Best epoch so far, target metric decreased to -0.94000 from -0.92000.)
== Epoch 22
 Train:  0.0089 loss | Accuracy = 0.861 | 170.59 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.940 | 104.86 graphs/s
== Epoch 23
 Train:  0.0092 loss | Accuracy = 0.856 | 176.78 graphs/s
 Valid:  0.0132 loss | Accuracy = 0.780 | 116.78 graphs/s
== Epoch 24
 Train:  0.0088 loss | Accuracy = 0.871 | 180.45 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.940 | 93.44 graphs/s
== Epoch 25
 Train:  0.0087 loss | Accuracy = 0.882 | 171.75 graphs/s
 Valid:  0.0094 loss | Accuracy = 0.940 | 111.58 graphs/s
== Epoch 26
 Train:  0.0085 loss | Accuracy = 0.867 | 173.43 graphs/s
 Valid:  0.0087 loss | Accuracy = 0.920 | 99.45 graphs/s
== Epoch 27
 Train:  0.0085 loss | Accuracy = 0.877 | 166.62 graphs/s
 Valid:  0.0091 loss | Accuracy = 0.900 | 99.59 graphs/s
== Epoch 28
 Train:  0.0083 loss | Accuracy = 0.874 | 167.15 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.900 | 105.51 graphs/s
== Epoch 29
 Train:  0.0081 loss | Accuracy = 0.887 | 171.99 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.880 | 91.56 graphs/s
== Epoch 30
 Train:  0.0089 loss | Accuracy = 0.863 | 163.02 graphs/s
 Valid:  0.0076 loss | Accuracy = 0.940 | 94.03 graphs/s
== Epoch 31
 Train:  0.0086 loss | Accuracy = 0.885 | 164.18 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.940 | 92.50 graphs/s
== Epoch 32
 Train:  0.0084 loss | Accuracy = 0.892 | 151.79 graphs/s
 Valid:  0.0132 loss | Accuracy = 0.860 | 97.73 graphs/s
== Epoch 33
 Train:  0.0086 loss | Accuracy = 0.881 | 169.55 graphs/s
 Valid:  0.0093 loss | Accuracy = 0.900 | 94.34 graphs/s
== Epoch 34
 Train:  0.0092 loss | Accuracy = 0.879 | 168.53 graphs/s
 Valid:  0.0113 loss | Accuracy = 0.820 | 107.53 graphs/s
== Epoch 35
 Train:  0.0087 loss | Accuracy = 0.877 | 176.71 graphs/s
 Valid:  0.0071 loss | Accuracy = 0.940 | 117.96 graphs/s
== Epoch 36
 Train:  0.0081 loss | Accuracy = 0.877 | 179.16 graphs/s
 Valid:  0.0068 loss | Accuracy = 0.940 | 103.64 graphs/s
== Epoch 37
 Train:  0.0080 loss | Accuracy = 0.881 | 191.56 graphs/s
 Valid:  0.0067 loss | Accuracy = 0.940 | 120.11 graphs/s
== Epoch 38
 Train:  0.0082 loss | Accuracy = 0.881 | 192.14 graphs/s
 Valid:  0.0074 loss | Accuracy = 0.940 | 115.57 graphs/s
== Epoch 39
 Train:  0.0091 loss | Accuracy = 0.874 | 182.85 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.920 | 105.68 graphs/s
== Epoch 40
 Train:  0.0091 loss | Accuracy = 0.874 | 157.79 graphs/s
 Valid:  0.0082 loss | Accuracy = 0.900 | 94.62 graphs/s
== Epoch 41
 Train:  0.0089 loss | Accuracy = 0.876 | 159.30 graphs/s
 Valid:  0.0076 loss | Accuracy = 0.920 | 98.50 graphs/s
== Epoch 42
 Train:  0.0090 loss | Accuracy = 0.866 | 156.88 graphs/s
 Valid:  0.0070 loss | Accuracy = 0.940 | 91.73 graphs/s
== Epoch 43
 Train:  0.0093 loss | Accuracy = 0.859 | 159.81 graphs/s
 Valid:  0.0067 loss | Accuracy = 0.940 | 91.09 graphs/s
== Epoch 44
 Train:  0.0082 loss | Accuracy = 0.881 | 153.46 graphs/s
 Valid:  0.0066 loss | Accuracy = 0.940 | 98.78 graphs/s
== Epoch 45
 Train:  0.0079 loss | Accuracy = 0.884 | 156.89 graphs/s
 Valid:  0.0066 loss | Accuracy = 0.940 | 88.17 graphs/s
== Epoch 46
 Train:  0.0074 loss | Accuracy = 0.885 | 178.21 graphs/s
 Valid:  0.0085 loss | Accuracy = 0.940 | 88.68 graphs/s
Stopping training after 25 epochs without improvement on validation metric.
Training took 192.41762447357178s. Best validation metric: -0.9399999976158142
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_0/ast.
Restoring best model state from result_nvidia_new_0/RGIN_GraphBinaryClassification__2020-06-28_20-52-21_best.pkl.
Accuracy = 0.826
