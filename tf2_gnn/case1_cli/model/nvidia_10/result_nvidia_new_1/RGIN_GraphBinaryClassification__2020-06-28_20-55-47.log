Setting random seed 0.
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
Initial valid metric: Accuracy = 0.660.
== Epoch 1
 Train:  0.0280 loss | Accuracy = 0.589 | 148.08 graphs/s
 Valid:  0.0264 loss | Accuracy = 0.580 | 115.14 graphs/s
== Epoch 2
 Train:  0.0222 loss | Accuracy = 0.615 | 174.29 graphs/s
 Valid:  0.0228 loss | Accuracy = 0.680 | 106.60 graphs/s
  (Best epoch so far, target metric decreased to -0.68000 from -0.66000.)
== Epoch 3
 Train:  0.0206 loss | Accuracy = 0.658 | 173.46 graphs/s
 Valid:  0.0214 loss | Accuracy = 0.700 | 110.84 graphs/s
  (Best epoch so far, target metric decreased to -0.70000 from -0.68000.)
== Epoch 4
 Train:  0.0198 loss | Accuracy = 0.682 | 167.40 graphs/s
 Valid:  0.0192 loss | Accuracy = 0.740 | 92.76 graphs/s
  (Best epoch so far, target metric decreased to -0.74000 from -0.70000.)
== Epoch 5
 Train:  0.0191 loss | Accuracy = 0.678 | 156.37 graphs/s
 Valid:  0.0159 loss | Accuracy = 0.860 | 106.76 graphs/s
  (Best epoch so far, target metric decreased to -0.86000 from -0.74000.)
== Epoch 6
 Train:  0.0184 loss | Accuracy = 0.707 | 166.50 graphs/s
 Valid:  0.0182 loss | Accuracy = 0.740 | 102.06 graphs/s
== Epoch 7
 Train:  0.0171 loss | Accuracy = 0.741 | 171.05 graphs/s
 Valid:  0.0162 loss | Accuracy = 0.720 | 112.02 graphs/s
== Epoch 8
 Train:  0.0151 loss | Accuracy = 0.789 | 170.60 graphs/s
 Valid:  0.0154 loss | Accuracy = 0.840 | 93.47 graphs/s
== Epoch 9
 Train:  0.0149 loss | Accuracy = 0.781 | 166.67 graphs/s
 Valid:  0.0134 loss | Accuracy = 0.900 | 111.43 graphs/s
  (Best epoch so far, target metric decreased to -0.90000 from -0.86000.)
== Epoch 10
 Train:  0.0139 loss | Accuracy = 0.807 | 162.71 graphs/s
 Valid:  0.0112 loss | Accuracy = 0.880 | 105.39 graphs/s
== Epoch 11
 Train:  0.0125 loss | Accuracy = 0.827 | 167.14 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.920 | 80.94 graphs/s
  (Best epoch so far, target metric decreased to -0.92000 from -0.90000.)
== Epoch 12
 Train:  0.0118 loss | Accuracy = 0.841 | 158.45 graphs/s
 Valid:  0.0107 loss | Accuracy = 0.900 | 85.90 graphs/s
== Epoch 13
 Train:  0.0112 loss | Accuracy = 0.836 | 165.15 graphs/s
 Valid:  0.0117 loss | Accuracy = 0.900 | 102.31 graphs/s
== Epoch 14
 Train:  0.0117 loss | Accuracy = 0.830 | 177.68 graphs/s
 Valid:  0.0108 loss | Accuracy = 0.900 | 114.73 graphs/s
== Epoch 15
 Train:  0.0114 loss | Accuracy = 0.836 | 177.92 graphs/s
 Valid:  0.0109 loss | Accuracy = 0.900 | 103.71 graphs/s
== Epoch 16
 Train:  0.0103 loss | Accuracy = 0.853 | 181.94 graphs/s
 Valid:  0.0134 loss | Accuracy = 0.760 | 115.13 graphs/s
== Epoch 17
 Train:  0.0100 loss | Accuracy = 0.859 | 168.69 graphs/s
 Valid:  0.0125 loss | Accuracy = 0.900 | 90.20 graphs/s
== Epoch 18
 Train:  0.0113 loss | Accuracy = 0.843 | 162.02 graphs/s
 Valid:  0.0106 loss | Accuracy = 0.900 | 85.73 graphs/s
== Epoch 19
 Train:  0.0097 loss | Accuracy = 0.858 | 141.42 graphs/s
 Valid:  0.0109 loss | Accuracy = 0.900 | 97.53 graphs/s
== Epoch 20
 Train:  0.0093 loss | Accuracy = 0.861 | 162.71 graphs/s
 Valid:  0.0116 loss | Accuracy = 0.900 | 89.01 graphs/s
== Epoch 21
 Train:  0.0091 loss | Accuracy = 0.866 | 153.13 graphs/s
 Valid:  0.0135 loss | Accuracy = 0.900 | 87.70 graphs/s
== Epoch 22
 Train:  0.0097 loss | Accuracy = 0.856 | 164.23 graphs/s
 Valid:  0.0133 loss | Accuracy = 0.900 | 98.43 graphs/s
== Epoch 23
 Train:  0.0091 loss | Accuracy = 0.866 | 162.21 graphs/s
 Valid:  0.0120 loss | Accuracy = 0.900 | 93.36 graphs/s
== Epoch 24
 Train:  0.0092 loss | Accuracy = 0.876 | 162.67 graphs/s
 Valid:  0.0147 loss | Accuracy = 0.900 | 97.73 graphs/s
== Epoch 25
 Train:  0.0090 loss | Accuracy = 0.867 | 165.29 graphs/s
 Valid:  0.0119 loss | Accuracy = 0.900 | 99.81 graphs/s
== Epoch 26
 Train:  0.0097 loss | Accuracy = 0.856 | 162.21 graphs/s
 Valid:  0.0118 loss | Accuracy = 0.900 | 87.76 graphs/s
== Epoch 27
 Train:  0.0091 loss | Accuracy = 0.864 | 158.81 graphs/s
 Valid:  0.0172 loss | Accuracy = 0.900 | 109.59 graphs/s
== Epoch 28
 Train:  0.0096 loss | Accuracy = 0.853 | 165.66 graphs/s
 Valid:  0.0134 loss | Accuracy = 0.900 | 96.53 graphs/s
== Epoch 29
 Train:  0.0092 loss | Accuracy = 0.866 | 157.82 graphs/s
 Valid:  0.0156 loss | Accuracy = 0.900 | 97.74 graphs/s
== Epoch 30
 Train:  0.0095 loss | Accuracy = 0.869 | 164.57 graphs/s
 Valid:  0.0127 loss | Accuracy = 0.900 | 90.19 graphs/s
== Epoch 31
 Train:  0.0089 loss | Accuracy = 0.856 | 168.30 graphs/s
 Valid:  0.0163 loss | Accuracy = 0.900 | 80.98 graphs/s
== Epoch 32
 Train:  0.0094 loss | Accuracy = 0.867 | 169.94 graphs/s
 Valid:  0.0133 loss | Accuracy = 0.900 | 101.97 graphs/s
== Epoch 33
 Train:  0.0085 loss | Accuracy = 0.864 | 177.86 graphs/s
 Valid:  0.0102 loss | Accuracy = 0.900 | 104.74 graphs/s
== Epoch 34
 Train:  0.0084 loss | Accuracy = 0.881 | 169.08 graphs/s
 Valid:  0.0090 loss | Accuracy = 0.900 | 88.14 graphs/s
== Epoch 35
 Train:  0.0086 loss | Accuracy = 0.863 | 155.03 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.920 | 89.19 graphs/s
== Epoch 36
 Train:  0.0078 loss | Accuracy = 0.884 | 166.85 graphs/s
 Valid:  0.0097 loss | Accuracy = 0.880 | 97.13 graphs/s
Stopping training after 25 epochs without improvement on validation metric.
Training took 152.35688424110413s. Best validation metric: -0.9200000166893005
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/nvidia/new_1/ast.
Restoring best model state from result_nvidia_new_1/RGIN_GraphBinaryClassification__2020-06-28_20-55-47_best.pkl.
Accuracy = 0.812
