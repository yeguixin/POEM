Setting random seed 0.
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
Initial valid metric: Accuracy = 0.420.
== Epoch 1
 Train:  0.0264 loss | Accuracy = 0.562 | 126.35 graphs/s
 Valid:  0.0275 loss | Accuracy = 0.600 | 100.06 graphs/s
  (Best epoch so far, target metric decreased to -0.60000 from -0.42000.)
== Epoch 2
 Train:  0.0228 loss | Accuracy = 0.583 | 163.90 graphs/s
 Valid:  0.0247 loss | Accuracy = 0.700 | 93.33 graphs/s
  (Best epoch so far, target metric decreased to -0.70000 from -0.60000.)
== Epoch 3
 Train:  0.0209 loss | Accuracy = 0.652 | 166.28 graphs/s
 Valid:  0.0227 loss | Accuracy = 0.720 | 100.66 graphs/s
  (Best epoch so far, target metric decreased to -0.72000 from -0.70000.)
== Epoch 4
 Train:  0.0199 loss | Accuracy = 0.681 | 160.95 graphs/s
 Valid:  0.0209 loss | Accuracy = 0.820 | 98.79 graphs/s
  (Best epoch so far, target metric decreased to -0.82000 from -0.72000.)
== Epoch 5
 Train:  0.0190 loss | Accuracy = 0.703 | 165.53 graphs/s
 Valid:  0.0196 loss | Accuracy = 0.820 | 113.73 graphs/s
== Epoch 6
 Train:  0.0188 loss | Accuracy = 0.706 | 158.88 graphs/s
 Valid:  0.0207 loss | Accuracy = 0.780 | 95.74 graphs/s
== Epoch 7
 Train:  0.0164 loss | Accuracy = 0.770 | 159.08 graphs/s
 Valid:  0.0194 loss | Accuracy = 0.840 | 83.84 graphs/s
  (Best epoch so far, target metric decreased to -0.84000 from -0.82000.)
== Epoch 8
 Train:  0.0154 loss | Accuracy = 0.788 | 162.61 graphs/s
 Valid:  0.0178 loss | Accuracy = 0.820 | 90.14 graphs/s
== Epoch 9
 Train:  0.0149 loss | Accuracy = 0.784 | 163.75 graphs/s
 Valid:  0.0199 loss | Accuracy = 0.800 | 89.00 graphs/s
== Epoch 10
 Train:  0.0143 loss | Accuracy = 0.779 | 159.64 graphs/s
 Valid:  0.0176 loss | Accuracy = 0.760 | 96.53 graphs/s
== Epoch 11
 Train:  0.0142 loss | Accuracy = 0.788 | 162.77 graphs/s
 Valid:  0.0179 loss | Accuracy = 0.760 | 101.01 graphs/s
== Epoch 12
 Train:  0.0134 loss | Accuracy = 0.802 | 168.39 graphs/s
 Valid:  0.0156 loss | Accuracy = 0.820 | 108.75 graphs/s
== Epoch 13
 Train:  0.0127 loss | Accuracy = 0.825 | 154.99 graphs/s
 Valid:  0.0163 loss | Accuracy = 0.800 | 94.38 graphs/s
== Epoch 14
 Train:  0.0126 loss | Accuracy = 0.827 | 172.55 graphs/s
 Valid:  0.0158 loss | Accuracy = 0.800 | 111.35 graphs/s
== Epoch 15
 Train:  0.0122 loss | Accuracy = 0.820 | 176.91 graphs/s
 Valid:  0.0140 loss | Accuracy = 0.860 | 95.20 graphs/s
  (Best epoch so far, target metric decreased to -0.86000 from -0.84000.)
== Epoch 16
 Train:  0.0119 loss | Accuracy = 0.817 | 164.88 graphs/s
 Valid:  0.0127 loss | Accuracy = 0.860 | 102.56 graphs/s
== Epoch 17
 Train:  0.0124 loss | Accuracy = 0.797 | 167.01 graphs/s
 Valid:  0.0151 loss | Accuracy = 0.860 | 103.02 graphs/s
== Epoch 18
 Train:  0.0104 loss | Accuracy = 0.861 | 167.44 graphs/s
 Valid:  0.0139 loss | Accuracy = 0.760 | 94.79 graphs/s
== Epoch 19
 Train:  0.0106 loss | Accuracy = 0.840 | 155.60 graphs/s
 Valid:  0.0126 loss | Accuracy = 0.900 | 77.49 graphs/s
  (Best epoch so far, target metric decreased to -0.90000 from -0.86000.)
== Epoch 20
 Train:  0.0098 loss | Accuracy = 0.868 | 148.47 graphs/s
 Valid:  0.0148 loss | Accuracy = 0.760 | 95.98 graphs/s
== Epoch 21
 Train:  0.0094 loss | Accuracy = 0.873 | 155.63 graphs/s
 Valid:  0.0135 loss | Accuracy = 0.840 | 91.20 graphs/s
== Epoch 22
 Train:  0.0094 loss | Accuracy = 0.881 | 157.92 graphs/s
 Valid:  0.0125 loss | Accuracy = 0.920 | 91.59 graphs/s
  (Best epoch so far, target metric decreased to -0.92000 from -0.90000.)
== Epoch 23
 Train:  0.0102 loss | Accuracy = 0.861 | 160.58 graphs/s
 Valid:  0.0126 loss | Accuracy = 0.880 | 102.86 graphs/s
== Epoch 24
 Train:  0.0095 loss | Accuracy = 0.858 | 154.75 graphs/s
 Valid:  0.0120 loss | Accuracy = 0.900 | 93.96 graphs/s
== Epoch 25
 Train:  0.0093 loss | Accuracy = 0.871 | 142.95 graphs/s
 Valid:  0.0120 loss | Accuracy = 0.780 | 81.28 graphs/s
== Epoch 26
 Train:  0.0088 loss | Accuracy = 0.877 | 171.97 graphs/s
 Valid:  0.0113 loss | Accuracy = 0.820 | 93.80 graphs/s
== Epoch 27
 Train:  0.0083 loss | Accuracy = 0.882 | 164.99 graphs/s
 Valid:  0.0103 loss | Accuracy = 0.880 | 92.43 graphs/s
== Epoch 28
 Train:  0.0087 loss | Accuracy = 0.869 | 159.14 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.900 | 101.98 graphs/s
== Epoch 29
 Train:  0.0085 loss | Accuracy = 0.884 | 170.11 graphs/s
 Valid:  0.0102 loss | Accuracy = 0.920 | 98.20 graphs/s
== Epoch 30
 Train:  0.0085 loss | Accuracy = 0.879 | 157.66 graphs/s
 Valid:  0.0095 loss | Accuracy = 0.940 | 102.52 graphs/s
  (Best epoch so far, target metric decreased to -0.94000 from -0.92000.)
== Epoch 31
 Train:  0.0082 loss | Accuracy = 0.891 | 161.82 graphs/s
 Valid:  0.0093 loss | Accuracy = 0.940 | 105.31 graphs/s
== Epoch 32
 Train:  0.0088 loss | Accuracy = 0.897 | 161.75 graphs/s
 Valid:  0.0092 loss | Accuracy = 0.900 | 104.48 graphs/s
== Epoch 33
 Train:  0.0084 loss | Accuracy = 0.894 | 168.36 graphs/s
 Valid:  0.0093 loss | Accuracy = 0.940 | 104.91 graphs/s
== Epoch 34
 Train:  0.0082 loss | Accuracy = 0.884 | 156.85 graphs/s
 Valid:  0.0095 loss | Accuracy = 0.900 | 86.36 graphs/s
== Epoch 35
 Train:  0.0074 loss | Accuracy = 0.895 | 159.43 graphs/s
 Valid:  0.0086 loss | Accuracy = 0.940 | 90.03 graphs/s
== Epoch 36
 Train:  0.0073 loss | Accuracy = 0.892 | 163.97 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.940 | 89.03 graphs/s
== Epoch 37
 Train:  0.0072 loss | Accuracy = 0.913 | 154.28 graphs/s
 Valid:  0.0085 loss | Accuracy = 0.900 | 89.75 graphs/s
== Epoch 38
 Train:  0.0069 loss | Accuracy = 0.908 | 147.27 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.920 | 81.90 graphs/s
== Epoch 39
 Train:  0.0068 loss | Accuracy = 0.915 | 164.42 graphs/s
 Valid:  0.0085 loss | Accuracy = 0.940 | 85.38 graphs/s
== Epoch 40
 Train:  0.0074 loss | Accuracy = 0.907 | 170.67 graphs/s
 Valid:  0.0079 loss | Accuracy = 0.980 | 100.96 graphs/s
  (Best epoch so far, target metric decreased to -0.98000 from -0.94000.)
== Epoch 41
 Train:  0.0077 loss | Accuracy = 0.912 | 159.28 graphs/s
 Valid:  0.0084 loss | Accuracy = 0.920 | 98.12 graphs/s
== Epoch 42
 Train:  0.0074 loss | Accuracy = 0.899 | 149.30 graphs/s
 Valid:  0.0079 loss | Accuracy = 0.920 | 87.33 graphs/s
== Epoch 43
 Train:  0.0067 loss | Accuracy = 0.920 | 162.79 graphs/s
 Valid:  0.0071 loss | Accuracy = 0.980 | 79.42 graphs/s
== Epoch 44
 Train:  0.0068 loss | Accuracy = 0.912 | 166.31 graphs/s
 Valid:  0.0072 loss | Accuracy = 0.940 | 102.00 graphs/s
== Epoch 45
 Train:  0.0067 loss | Accuracy = 0.920 | 171.15 graphs/s
 Valid:  0.0071 loss | Accuracy = 0.980 | 95.98 graphs/s
== Epoch 46
 Train:  0.0064 loss | Accuracy = 0.933 | 157.46 graphs/s
 Valid:  0.0073 loss | Accuracy = 0.980 | 82.78 graphs/s
== Epoch 47
 Train:  0.0064 loss | Accuracy = 0.928 | 161.42 graphs/s
 Valid:  0.0070 loss | Accuracy = 0.980 | 94.33 graphs/s
== Epoch 48
 Train:  0.0063 loss | Accuracy = 0.923 | 152.07 graphs/s
 Valid:  0.0068 loss | Accuracy = 0.960 | 79.22 graphs/s
== Epoch 49
 Train:  0.0061 loss | Accuracy = 0.930 | 147.22 graphs/s
 Valid:  0.0068 loss | Accuracy = 0.980 | 89.98 graphs/s
== Epoch 50
 Train:  0.0066 loss | Accuracy = 0.930 | 167.59 graphs/s
 Valid:  0.0071 loss | Accuracy = 0.980 | 111.69 graphs/s
== Epoch 51
 Train:  0.0065 loss | Accuracy = 0.915 | 163.11 graphs/s
 Valid:  0.0069 loss | Accuracy = 0.980 | 96.34 graphs/s
== Epoch 52
 Train:  0.0065 loss | Accuracy = 0.926 | 163.73 graphs/s
 Valid:  0.0067 loss | Accuracy = 0.940 | 96.80 graphs/s
== Epoch 53
 Train:  0.0061 loss | Accuracy = 0.933 | 154.81 graphs/s
 Valid:  0.0068 loss | Accuracy = 0.960 | 94.87 graphs/s
== Epoch 54
 Train:  0.0065 loss | Accuracy = 0.931 | 159.23 graphs/s
 Valid:  0.0066 loss | Accuracy = 0.980 | 83.59 graphs/s
== Epoch 55
 Train:  0.0060 loss | Accuracy = 0.935 | 163.15 graphs/s
 Valid:  0.0064 loss | Accuracy = 0.980 | 85.65 graphs/s
== Epoch 56
 Train:  0.0060 loss | Accuracy = 0.926 | 161.44 graphs/s
 Valid:  0.0069 loss | Accuracy = 0.940 | 93.15 graphs/s
== Epoch 57
 Train:  0.0059 loss | Accuracy = 0.943 | 163.31 graphs/s
 Valid:  0.0067 loss | Accuracy = 0.980 | 93.06 graphs/s
== Epoch 58
 Train:  0.0062 loss | Accuracy = 0.922 | 164.81 graphs/s
 Valid:  0.0064 loss | Accuracy = 0.980 | 101.68 graphs/s
== Epoch 59
 Train:  0.0060 loss | Accuracy = 0.928 | 156.68 graphs/s
 Valid:  0.0070 loss | Accuracy = 0.980 | 106.50 graphs/s
== Epoch 60
 Train:  0.0059 loss | Accuracy = 0.936 | 160.98 graphs/s
 Valid:  0.0063 loss | Accuracy = 0.980 | 96.37 graphs/s
== Epoch 61
 Train:  0.0057 loss | Accuracy = 0.940 | 157.40 graphs/s
 Valid:  0.0063 loss | Accuracy = 0.980 | 85.74 graphs/s
== Epoch 62
 Train:  0.0058 loss | Accuracy = 0.935 | 162.06 graphs/s
 Valid:  0.0066 loss | Accuracy = 0.980 | 79.87 graphs/s
== Epoch 63
 Train:  0.0057 loss | Accuracy = 0.941 | 140.31 graphs/s
 Valid:  0.0065 loss | Accuracy = 0.980 | 92.62 graphs/s
== Epoch 64
 Train:  0.0058 loss | Accuracy = 0.944 | 166.46 graphs/s
 Valid:  0.0065 loss | Accuracy = 0.980 | 111.66 graphs/s
== Epoch 65
 Train:  0.0058 loss | Accuracy = 0.936 | 174.47 graphs/s
 Valid:  0.0064 loss | Accuracy = 0.980 | 108.99 graphs/s
Stopping training after 25 epochs without improvement on validation metric.
Training took 283.4881591796875s. Best validation metric: -0.9800000190734863
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_1/ast.
Restoring best model state from result_amd_new_1/RGIN_GraphBinaryClassification__2020-06-28_23-54-37_best.pkl.
Accuracy = 0.735
