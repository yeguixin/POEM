Setting random seed 0.
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.001}
Initial valid metric: Accuracy = 0.420.
== Epoch 1
 Train:  0.0267 loss | Accuracy = 0.510 | 147.91 graphs/s
 Valid:  0.0279 loss | Accuracy = 0.600 | 114.10 graphs/s
  (Best epoch so far, target metric decreased to -0.60000 from -0.42000.)
== Epoch 2
 Train:  0.0220 loss | Accuracy = 0.606 | 175.65 graphs/s
 Valid:  0.0255 loss | Accuracy = 0.660 | 99.11 graphs/s
  (Best epoch so far, target metric decreased to -0.66000 from -0.60000.)
== Epoch 3
 Train:  0.0211 loss | Accuracy = 0.627 | 176.04 graphs/s
 Valid:  0.0244 loss | Accuracy = 0.680 | 99.62 graphs/s
  (Best epoch so far, target metric decreased to -0.68000 from -0.66000.)
== Epoch 4
 Train:  0.0194 loss | Accuracy = 0.683 | 185.19 graphs/s
 Valid:  0.0245 loss | Accuracy = 0.620 | 106.61 graphs/s
== Epoch 5
 Train:  0.0183 loss | Accuracy = 0.716 | 185.81 graphs/s
 Valid:  0.0219 loss | Accuracy = 0.700 | 104.08 graphs/s
  (Best epoch so far, target metric decreased to -0.70000 from -0.68000.)
== Epoch 6
 Train:  0.0171 loss | Accuracy = 0.717 | 178.31 graphs/s
 Valid:  0.0207 loss | Accuracy = 0.740 | 93.51 graphs/s
  (Best epoch so far, target metric decreased to -0.74000 from -0.70000.)
== Epoch 7
 Train:  0.0162 loss | Accuracy = 0.763 | 165.60 graphs/s
 Valid:  0.0213 loss | Accuracy = 0.680 | 102.58 graphs/s
== Epoch 8
 Train:  0.0162 loss | Accuracy = 0.737 | 161.33 graphs/s
 Valid:  0.0190 loss | Accuracy = 0.760 | 102.49 graphs/s
  (Best epoch so far, target metric decreased to -0.76000 from -0.74000.)
== Epoch 9
 Train:  0.0153 loss | Accuracy = 0.773 | 175.81 graphs/s
 Valid:  0.0188 loss | Accuracy = 0.800 | 96.67 graphs/s
  (Best epoch so far, target metric decreased to -0.80000 from -0.76000.)
== Epoch 10
 Train:  0.0150 loss | Accuracy = 0.768 | 163.57 graphs/s
 Valid:  0.0188 loss | Accuracy = 0.720 | 89.92 graphs/s
== Epoch 11
 Train:  0.0141 loss | Accuracy = 0.784 | 167.69 graphs/s
 Valid:  0.0154 loss | Accuracy = 0.860 | 92.00 graphs/s
  (Best epoch so far, target metric decreased to -0.86000 from -0.80000.)
== Epoch 12
 Train:  0.0149 loss | Accuracy = 0.783 | 168.55 graphs/s
 Valid:  0.0160 loss | Accuracy = 0.840 | 91.01 graphs/s
== Epoch 13
 Train:  0.0129 loss | Accuracy = 0.794 | 159.13 graphs/s
 Valid:  0.0149 loss | Accuracy = 0.840 | 87.53 graphs/s
== Epoch 14
 Train:  0.0120 loss | Accuracy = 0.830 | 163.13 graphs/s
 Valid:  0.0153 loss | Accuracy = 0.820 | 101.30 graphs/s
== Epoch 15
 Train:  0.0125 loss | Accuracy = 0.825 | 174.37 graphs/s
 Valid:  0.0140 loss | Accuracy = 0.860 | 100.11 graphs/s
== Epoch 16
 Train:  0.0123 loss | Accuracy = 0.809 | 173.28 graphs/s
 Valid:  0.0142 loss | Accuracy = 0.840 | 98.64 graphs/s
== Epoch 17
 Train:  0.0121 loss | Accuracy = 0.822 | 174.22 graphs/s
 Valid:  0.0137 loss | Accuracy = 0.860 | 103.69 graphs/s
== Epoch 18
 Train:  0.0114 loss | Accuracy = 0.843 | 165.54 graphs/s
 Valid:  0.0140 loss | Accuracy = 0.860 | 91.80 graphs/s
== Epoch 19
 Train:  0.0112 loss | Accuracy = 0.832 | 153.41 graphs/s
 Valid:  0.0134 loss | Accuracy = 0.860 | 99.53 graphs/s
== Epoch 20
 Train:  0.0105 loss | Accuracy = 0.855 | 180.96 graphs/s
 Valid:  0.0121 loss | Accuracy = 0.880 | 98.76 graphs/s
  (Best epoch so far, target metric decreased to -0.88000 from -0.86000.)
== Epoch 21
 Train:  0.0106 loss | Accuracy = 0.843 | 178.66 graphs/s
 Valid:  0.0114 loss | Accuracy = 0.900 | 91.74 graphs/s
  (Best epoch so far, target metric decreased to -0.90000 from -0.88000.)
== Epoch 22
 Train:  0.0101 loss | Accuracy = 0.873 | 173.48 graphs/s
 Valid:  0.0123 loss | Accuracy = 0.860 | 96.36 graphs/s
== Epoch 23
 Train:  0.0103 loss | Accuracy = 0.864 | 161.36 graphs/s
 Valid:  0.0110 loss | Accuracy = 0.920 | 96.85 graphs/s
  (Best epoch so far, target metric decreased to -0.92000 from -0.90000.)
== Epoch 24
 Train:  0.0108 loss | Accuracy = 0.835 | 169.43 graphs/s
 Valid:  0.0119 loss | Accuracy = 0.860 | 101.98 graphs/s
== Epoch 25
 Train:  0.0098 loss | Accuracy = 0.856 | 176.26 graphs/s
 Valid:  0.0112 loss | Accuracy = 0.880 | 106.35 graphs/s
== Epoch 26
 Train:  0.0094 loss | Accuracy = 0.863 | 171.04 graphs/s
 Valid:  0.0103 loss | Accuracy = 0.900 | 92.73 graphs/s
== Epoch 27
 Train:  0.0096 loss | Accuracy = 0.863 | 173.42 graphs/s
 Valid:  0.0107 loss | Accuracy = 0.880 | 106.68 graphs/s
== Epoch 28
 Train:  0.0098 loss | Accuracy = 0.868 | 174.52 graphs/s
 Valid:  0.0106 loss | Accuracy = 0.900 | 96.28 graphs/s
== Epoch 29
 Train:  0.0103 loss | Accuracy = 0.850 | 169.35 graphs/s
 Valid:  0.0107 loss | Accuracy = 0.880 | 96.52 graphs/s
== Epoch 30
 Train:  0.0096 loss | Accuracy = 0.873 | 168.11 graphs/s
 Valid:  0.0105 loss | Accuracy = 0.880 | 99.08 graphs/s
== Epoch 31
 Train:  0.0092 loss | Accuracy = 0.882 | 157.31 graphs/s
 Valid:  0.0098 loss | Accuracy = 0.900 | 91.05 graphs/s
== Epoch 32
 Train:  0.0092 loss | Accuracy = 0.871 | 162.10 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.900 | 86.86 graphs/s
== Epoch 33
 Train:  0.0082 loss | Accuracy = 0.910 | 157.65 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.900 | 90.22 graphs/s
== Epoch 34
 Train:  0.0082 loss | Accuracy = 0.897 | 156.79 graphs/s
 Valid:  0.0094 loss | Accuracy = 0.900 | 85.24 graphs/s
== Epoch 35
 Train:  0.0083 loss | Accuracy = 0.892 | 169.21 graphs/s
 Valid:  0.0087 loss | Accuracy = 0.920 | 104.61 graphs/s
== Epoch 36
 Train:  0.0090 loss | Accuracy = 0.871 | 183.14 graphs/s
 Valid:  0.0102 loss | Accuracy = 0.920 | 107.17 graphs/s
== Epoch 37
 Train:  0.0088 loss | Accuracy = 0.895 | 180.30 graphs/s
 Valid:  0.0102 loss | Accuracy = 0.880 | 103.36 graphs/s
== Epoch 38
 Train:  0.0093 loss | Accuracy = 0.871 | 170.95 graphs/s
 Valid:  0.0092 loss | Accuracy = 0.920 | 107.06 graphs/s
== Epoch 39
 Train:  0.0093 loss | Accuracy = 0.887 | 155.57 graphs/s
 Valid:  0.0093 loss | Accuracy = 0.900 | 102.40 graphs/s
== Epoch 40
 Train:  0.0100 loss | Accuracy = 0.846 | 176.78 graphs/s
 Valid:  0.0109 loss | Accuracy = 0.880 | 100.16 graphs/s
== Epoch 41
 Train:  0.0095 loss | Accuracy = 0.871 | 192.73 graphs/s
 Valid:  0.0102 loss | Accuracy = 0.880 | 118.97 graphs/s
== Epoch 42
 Train:  0.0097 loss | Accuracy = 0.851 | 187.47 graphs/s
 Valid:  0.0103 loss | Accuracy = 0.860 | 105.01 graphs/s
== Epoch 43
 Train:  0.0097 loss | Accuracy = 0.871 | 186.12 graphs/s
 Valid:  0.0096 loss | Accuracy = 0.920 | 105.18 graphs/s
== Epoch 44
 Train:  0.0107 loss | Accuracy = 0.855 | 175.95 graphs/s
 Valid:  0.0100 loss | Accuracy = 0.860 | 100.07 graphs/s
== Epoch 45
 Train:  0.0090 loss | Accuracy = 0.869 | 177.88 graphs/s
 Valid:  0.0097 loss | Accuracy = 0.900 | 99.76 graphs/s
== Epoch 46
 Train:  0.0086 loss | Accuracy = 0.876 | 173.75 graphs/s
 Valid:  0.0087 loss | Accuracy = 0.880 | 106.35 graphs/s
== Epoch 47
 Train:  0.0081 loss | Accuracy = 0.889 | 173.61 graphs/s
 Valid:  0.0081 loss | Accuracy = 0.920 | 92.47 graphs/s
== Epoch 48
 Train:  0.0081 loss | Accuracy = 0.892 | 162.42 graphs/s
 Valid:  0.0105 loss | Accuracy = 0.860 | 91.75 graphs/s
Stopping training after 25 epochs without improvement on validation metric.
Training took 197.08001565933228s. Best validation metric: -0.9200000166893005
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_7/ast.
Restoring best model state from result_amd_new_7/RGIN_GraphBinaryClassification__2020-06-28_22-40-18_best.pkl.
Accuracy = 0.838
