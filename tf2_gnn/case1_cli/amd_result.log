start
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_0/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_0/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_0/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_0/ast.
Restoring best model state from model/amd_10//result_amd_new_0/RGIN_GraphBinaryClassification__2020-06-28_23-04-18_best.pkl.
tf.Tensor(
[1. 0. 1. 0. 0. 1. 0. 1. 1. 1. 0. 1. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 1.
 1. 1. 1. 0. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00623  |  Batch graph avg. loss = 0.00623  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1. 1. 1. 0. 1. 0. 1. 1. 1. 0. 1. 0.
 1. 0. 1. 1. 0. 1. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01059  |  Batch graph avg. loss = 0.01494  |  Steps per sec = 0.03979tf.Tensor([0. 0. 1. 1.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.02027  |  Batch graph avg. loss = 0.17528  |  Steps per sec = 0.07910[KAccuracy = 0.853
[06/29/2020, 10:25:19 AM] INFO (nni) Final result: 0.853
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_1/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_1/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_1/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_1/ast.
Restoring best model state from model/amd_10//result_amd_new_1/RGIN_GraphBinaryClassification__2020-06-28_23-54-37_best.pkl.
tf.Tensor(
[1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0.
 1. 1. 0. 0. 1. 1. 0. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01592  |  Batch graph avg. loss = 0.01592  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 1. 0. 0. 0. 1. 1. 1. 1. 1. 1.
 0. 0. 0. 0. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.02050  |  Batch graph avg. loss = 0.02507  |  Steps per sec = 0.03931tf.Tensor([1. 1. 1. 1.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01973  |  Batch graph avg. loss = 0.00748  |  Steps per sec = 0.07829[KAccuracy = 0.735
[06/29/2020, 10:26:03 AM] INFO (nni) Final result: 0.735
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_2/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_2/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_2/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_2/ast.
Restoring best model state from model/amd_10//result_amd_new_2/RGIN_GraphBinaryClassification__2020-06-28_23-11-59_best.pkl.
tf.Tensor(
[0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1.
 1. 1. 0. 0. 1. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01242  |  Batch graph avg. loss = 0.01242  |  Steps per sec = 0.00000tf.Tensor(
[1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 1. 0. 1. 1. 1. 0. 1. 1. 0. 1.
 0. 1. 1. 1. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01424  |  Batch graph avg. loss = 0.01606  |  Steps per sec = 0.03930tf.Tensor([0. 0. 0. 1.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01441  |  Batch graph avg. loss = 0.01712  |  Steps per sec = 0.07798[KAccuracy = 0.838
[06/29/2020, 10:26:46 AM] INFO (nni) Final result: 0.838
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_3/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_3/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_3/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_3/ast.
Restoring best model state from model/amd_10//result_amd_new_3/RGIN_GraphBinaryClassification__2020-06-28_23-16-33_best.pkl.
tf.Tensor(
[0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 0. 0. 0. 0. 0.
 1. 1. 1. 0. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00862  |  Batch graph avg. loss = 0.00862  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 0. 0. 0. 1. 1. 1. 0. 1. 1. 1. 0. 1. 0. 1. 1. 1. 0. 1. 1. 0. 1. 0.
 1. 0. 0. 1. 1. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01203  |  Batch graph avg. loss = 0.01544  |  Steps per sec = 0.03850tf.Tensor([0. 0. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01933  |  Batch graph avg. loss = 0.13609  |  Steps per sec = 0.07660[KAccuracy = 0.824
[06/29/2020, 10:27:30 AM] INFO (nni) Final result: 0.824
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_4/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_4/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_4/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_4/ast.
Restoring best model state from model/amd_10//result_amd_new_4/RGIN_GraphBinaryClassification__2020-06-28_22-24-53_best.pkl.
tf.Tensor(
[0. 1. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1. 0. 0. 1. 1. 0. 1. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00967  |  Batch graph avg. loss = 0.00967  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 0. 0. 0. 1. 1. 1. 0. 1. 0. 1. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1.
 0. 1. 0. 1. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01056  |  Batch graph avg. loss = 0.01145  |  Steps per sec = 0.03764tf.Tensor([1. 1. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01413  |  Batch graph avg. loss = 0.07130  |  Steps per sec = 0.07497[KAccuracy = 0.868
[06/29/2020, 10:28:15 AM] INFO (nni) Final result: 0.868
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_5/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_5/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_5/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_5/ast.
Restoring best model state from model/amd_10//result_amd_new_5/RGIN_GraphBinaryClassification__2020-06-28_22-30-37_best.pkl.
tf.Tensor(
[0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 1.
 1. 0. 1. 0. 0. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00922  |  Batch graph avg. loss = 0.00922  |  Steps per sec = 0.00000tf.Tensor(
[0. 1. 0. 1. 0. 0. 1. 0. 1. 1. 0. 1. 0. 0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0.
 0. 1. 1. 1. 1. 1. 0. 1.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.00871  |  Batch graph avg. loss = 0.00821  |  Steps per sec = 0.03882tf.Tensor([1. 0. 0. 1.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.00843  |  Batch graph avg. loss = 0.00386  |  Steps per sec = 0.07720[KAccuracy = 0.926
[06/29/2020, 10:28:59 AM] INFO (nni) Final result: 0.926
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_6/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_6/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_6/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_6/ast.
Restoring best model state from model/amd_10//result_amd_new_6/RGIN_GraphBinaryClassification__2020-06-28_22-36-00_best.pkl.
tf.Tensor(
[0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 0. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.00654  |  Batch graph avg. loss = 0.00654  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.
 1. 1. 1. 1. 1. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01100  |  Batch graph avg. loss = 0.01545  |  Steps per sec = 0.03903tf.Tensor([1. 1. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01248  |  Batch graph avg. loss = 0.03619  |  Steps per sec = 0.07763[KAccuracy = 0.809
[06/29/2020, 10:29:42 AM] INFO (nni) Final result: 0.809
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_7/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_7/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_7/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_7/ast.
Restoring best model state from model/amd_10//result_amd_new_7/RGIN_GraphBinaryClassification__2020-06-28_22-40-18_best.pkl.
tf.Tensor(
[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 0. 0. 0. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01037  |  Batch graph avg. loss = 0.01037  |  Steps per sec = 0.00000tf.Tensor(
[0. 1. 0. 0. 1. 1. 1. 0. 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 1. 1. 1. 1. 0. 1. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01251  |  Batch graph avg. loss = 0.01464  |  Steps per sec = 0.03965tf.Tensor([1. 0. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01257  |  Batch graph avg. loss = 0.01351  |  Steps per sec = 0.07891[KAccuracy = 0.838
[06/29/2020, 10:30:25 AM] INFO (nni) Final result: 0.838
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_8/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_8/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_8/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_8/ast.
Restoring best model state from model/amd_10//result_amd_new_8/RGIN_GraphBinaryClassification__2020-06-28_22-43-49_best.pkl.
tf.Tensor(
[0. 1. 1. 1. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 1. 1. 1. 0. 0. 0. 0. 0.
 0. 0. 1. 1. 1. 0. 1. 0.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01430  |  Batch graph avg. loss = 0.01430  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 1. 0. 0. 1. 0. 1. 1. 0. 1. 0. 1. 0. 0. 1. 0. 0. 0. 1. 1. 1. 1. 0.
 0. 1. 1. 1. 1. 0. 1. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01726  |  Batch graph avg. loss = 0.02022  |  Steps per sec = 0.03988tf.Tensor([0. 0. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01625  |  Batch graph avg. loss = 0.00009  |  Steps per sec = 0.07939[KAccuracy = 0.809
[06/29/2020, 10:31:08 AM] INFO (nni) Final result: 0.809
Setting random seed 0.
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_9/ast.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_9/test2.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Trying to load task/model-specific default parameters from /home/xibeiidaxue/tf2_gnn_zjq/merge_134/tf2_gnn/cli_utils/default_hypers/GraphBinaryClassification_RGIN_case1.json ... File found.
 Dataset default parameters: {'max_nodes_per_batch': 10000, 'num_fwd_edge_types': 6, 'add_self_loop_edges': True, 'tie_fwd_bkwd_edges': True, 'threshold_for_classification': None}
  Dataset parameters overridden by task defaults: {'threshold_for_classification': 0.5}
  Dataset parameters overridden by task/model defaults: {'max_nodes_per_batch': 32}
Loading data from /dev/shm/zjq/case1_data/amd/new_9/test3.
 Model default parameters: {'gnn_aggregation_function': 'sum', 'gnn_message_activation_function': 'relu', 'gnn_hidden_dim': 12, 'gnn_use_target_state_as_input': False, 'gnn_normalize_by_num_incoming': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_message_calculation_class': 'RGIN', 'gnn_initial_node_representation_activation': 'tanh', 'gnn_dense_intermediate_layer_activation': 'tanh', 'gnn_num_layers': 4, 'gnn_dense_every_num_layers': 2, 'gnn_residual_every_num_layers': 2, 'gnn_use_inter_layer_layernorm': False, 'gnn_layer_input_dropout_rate': 0.0, 'gnn_global_exchange_mode': 'gru', 'gnn_global_exchange_every_num_layers': 2, 'gnn_global_exchange_weighting_fun': 'softmax', 'gnn_global_exchange_num_heads': 4, 'gnn_global_exchange_dropout_rate': 0.2, 'optimizer': 'Adam', 'learning_rate': 0.001, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip_value': 1.0, 'use_intermediate_gnn_results': False, 'graph_aggregation_num_heads': 16, 'graph_aggregation_hidden_layers': [128], 'graph_aggregation_dropout_rate': 0.2}
  Model parameters overridden by task/model defaults: {'gnn_num_layers': 2, 'gnn_hidden_dim': 64, 'gnn_use_target_state_as_input': False, 'gnn_num_edge_MLP_hidden_layers': 1, 'gnn_num_aggr_MLP_hidden_layers': None, 'gnn_normalize_by_num_incoming': True, 'gnn_layer_input_dropout_rate': 0.1, 'gnn_dense_every_num_layers': 10000, 'gnn_residual_every_num_layers': 2, 'gnn_global_exchange_every_num_layers': 10000, 'gnn_use_inter_layer_layernorm': True, 'gnn_initial_node_representation_activation': 'relu', 'gnn_dense_intermediate_layer_activation': 'relu', 'gnn_message_activation_function': 'relu', 'gnn_aggregation_function': 'sum', 'learning_rate': 0.005, 'graph_aggregation_num_heads': 8, 'graph_aggregation_hidden_layers': [64], 'graph_aggregation_dropout_rate': 0.005}
Dataset parameters: {"max_nodes_per_batch": 32, "num_fwd_edge_types": 6, "add_self_loop_edges": true, "tie_fwd_bkwd_edges": true, "threshold_for_classification": 0.5}
Model parameters: {"gnn_aggregation_function": "sum", "gnn_message_activation_function": "relu", "gnn_hidden_dim": 64, "gnn_use_target_state_as_input": false, "gnn_normalize_by_num_incoming": true, "gnn_num_edge_MLP_hidden_layers": 1, "gnn_num_aggr_MLP_hidden_layers": null, "gnn_message_calculation_class": "RGIN", "gnn_initial_node_representation_activation": "relu", "gnn_dense_intermediate_layer_activation": "relu", "gnn_num_layers": 2, "gnn_dense_every_num_layers": 10000, "gnn_residual_every_num_layers": 2, "gnn_use_inter_layer_layernorm": true, "gnn_layer_input_dropout_rate": 0.1, "gnn_global_exchange_mode": "gru", "gnn_global_exchange_every_num_layers": 10000, "gnn_global_exchange_weighting_fun": "softmax", "gnn_global_exchange_num_heads": 4, "gnn_global_exchange_dropout_rate": 0.2, "optimizer": "Adam", "learning_rate": 0.005, "learning_rate_decay": 0.98, "momentum": 0.85, "gradient_clip_value": 1.0, "use_intermediate_gnn_results": false, "graph_aggregation_num_heads": 8, "graph_aggregation_hidden_layers": [64], "graph_aggregation_dropout_rate": 0.005}
== Running on test dataset
Loading data from /dev/shm/zjq/case1_data/amd/new_9/ast.
Restoring best model state from model/amd_10//result_amd_new_9/RGIN_GraphBinaryClassification__2020-06-29_00-09-55_best.pkl.
tf.Tensor(
[1. 1. 1. 0. 0. 1. 0. 1. 0. 1. 1. 1. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 0.
 1. 0. 0. 1. 1. 1. 1. 1.], shape=(32,), dtype=float32)
   Step:    0  |  Epoch graph avg. loss = 0.01271  |  Batch graph avg. loss = 0.01271  |  Steps per sec = 0.00000tf.Tensor(
[0. 0. 0. 0. 1. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0.
 1. 1. 0. 0. 0. 0. 0. 0.], shape=(32,), dtype=float32)
   Step:    1  |  Epoch graph avg. loss = 0.01501  |  Batch graph avg. loss = 0.01731  |  Steps per sec = 0.03947tf.Tensor([0. 0. 0. 0.], shape=(4,), dtype=float32)
   Step:    2  |  Epoch graph avg. loss = 0.01432  |  Batch graph avg. loss = 0.00329  |  Steps per sec = 0.07842[KAccuracy = 0.779
[06/29/2020, 10:31:52 AM] INFO (nni) Final result: 0.779
